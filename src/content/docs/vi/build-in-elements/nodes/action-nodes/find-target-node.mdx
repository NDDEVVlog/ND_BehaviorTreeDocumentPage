---
title: Find Target Node
description: Tìm kiếm game object gần nhất với tag cụ thể trong bán kính và lưu nó trên Blackboard.
---
import { Tabs, TabItem } from '@astrojs/starlight/components';

Action node này thực hiện tìm kiếm dựa trên physics để tìm target gần nhất. Nó rất cần thiết cho perception của AI.

**Đường dẫn trong Editor:** `Action > Perception > FindTarget`

### Thuộc tính

| Thuộc tính       | Type      | Mô tả                                                          |
| ---------------- | --------- | --------------------------------------------------------------- |
| `targetTag`      | string    | Tag của object cần tìm (ví dụ: "Player").                      |
| `searchRadius`   | float     | Bán kính tìm kiếm, tập trung vào AI.                           |
| `targetKey`      | Key       | Blackboard key (của type `Transform`) để lưu target tìm được.  |
| `searchLayer`    | LayerMask | Layer mask để sử dụng cho physics check.                       |

### Hành vi

-   **Trả về `Success`** nếu tìm thấy collider với `targetTag` khớp trong `searchRadius`. `Transform` của match gần nhất được lưu trong `targetKey` trên Blackboard.
-   **Trả về `Failure`** nếu không tìm thấy target khớp, hoặc nếu `targetKey` không được gán. Nếu target đã được lưu trước đó, giá trị của nó trên blackboard được đặt thành `null`.

<Tabs>
<TabItem label="C# Code">
```csharp
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

namespace ND_BehaviorTree
{
    [NodeInfo("Find Target", "Action/Perception/FindTarget", true, false)]
    public class FindTargetNode : ActionNode
    {
        [Tooltip("The tag of the object to find (e.g., 'Player').")]
        public string targetTag = "Player";
        [Tooltip("The radius to search within.")]
        public float searchRadius = 10.0f;
        [Tooltip("The Blackboard key (of type Transform) to store the found target.")]
        public Key targetKey;
        [Tooltip("The layer mask to use for the physics check.")]
        public LayerMask searchLayer;

        protected override Status OnProcess()
        {
            if (targetKey == null) return Status.Failure;

            Collider[] colliders = Physics.OverlapSphere(ownerTree.Self.transform.position, searchRadius, searchLayer);
            Transform closestTarget = null;
            float closestDistanceSqr = float.MaxValue;

            foreach (var collider in colliders)
            {
                if (collider.CompareTag(targetTag))
                {
                    float sqrDistance = (collider.transform.position - ownerTree.Self.transform.position).sqrMagnitude;
                    if (sqrDistance < closestDistanceSqr)
                    {
                        closestDistanceSqr = sqrDistance;
                        closestTarget = collider.transform;
                    }
                }
            }

            if (closestTarget != null)
            {
                blackboard.SetValue<Transform>(targetKey.name, closestTarget);
                return Status.Success;
            }

            blackboard.SetValue<Transform>(targetKey.name, null);
            return Status.Failure;
        }
    }
}
```
</TabItem>
</Tabs>

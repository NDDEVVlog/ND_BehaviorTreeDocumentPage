---
title: Tổng quan Composite Nodes
description: Composite Nodes là các nhánh của behavior tree điều khiển luồng thực thi.
---
import { Tabs, TabItem } from '@astrojs/starlight/components';

## Tổng quan

**Composite Nodes** là các nhánh nội bộ của behavior tree. Mục đích chính của chúng là định nghĩa luồng logic thực thi giữa các children của chúng. Chúng có thể có một hoặc nhiều children và sẽ xử lý chúng theo thứ tự cụ thể dựa trên loại composite (ví dụ: Sequence, Selector).

Composites cũng có thể có **Services** được gắn vào chúng, là các node đặc biệt chạy theo timer miễn là composite node đang hoạt động trong tree.

### Khái niệm cốt lõi
- **Có Children:** Composites là các parent node điều khiển một hoặc nhiều children.
- **Điều khiển Luồng:** Loại composite xác định cách children của nó được thực thi.
- **Services:** Chúng có thể host services thực hiện các tác vụ nền như kiểm tra kẻ địch.

<Tabs>
<TabItem label="C# Base Class">
```csharp
// --- START OF FILE CompositeNode.cs ---
using System.Collections;
using System.Collections.Generic;
using UnityEditorInternal;
using UnityEngine;

namespace ND_BehaviorTree
{
    public abstract class CompositeNode : Node
    {
        public List<Node> children = new List<Node>();
        public List<ServiceNode> services = new List<ServiceNode>();

        public override Node Clone()
        {
            CompositeNode node = base.Clone() as CompositeNode;
            node.children = new List<Node>();
            node.services = new List<ServiceNode>();
            return node;
        }

        public override void Reset()
        {
            base.Reset();
            children.ForEach(c => c.Reset());
            services.ForEach(s => s.Reset());
        }

        public override void AddChild(Node child)
        {
            if (children == null) children = new List<Node>();
            children.Add(child);
        }

        public override void RemoveChild(Node child)
        {
            if (children != null)
                children.Remove(child);
        }

        public override List<Node> GetChildren()
        {
            return new List<Node>(children);
        }
        
        protected void TickServices()
        {
            foreach (var service in services)
            {
                service.Process();
            }
        }
    }
}
```
</TabItem>
</Tabs>

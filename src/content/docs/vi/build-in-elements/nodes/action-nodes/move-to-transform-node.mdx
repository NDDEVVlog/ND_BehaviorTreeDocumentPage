---
title: Move To Transform Node
description: Di chuyển NavMeshAgent đến vị trí của target Transform được lưu trên Blackboard.
---
import { Tabs, TabItem, Aside } from '@astrojs/starlight/components';

Action node này ra lệnh cho `NavMeshAgent` di chuyển về phía target `Transform`. Nó cập nhật destination định kỳ để cho phép đuổi theo các target đang di chuyển.

**Đường dẫn trong Editor:** `Action > MoveToTransform`

### Thuộc tính

| Thuộc tính            | Type  | Mô tả                                                                                         |
| ---------------------- | ----- | --------------------------------------------------------------------------------------------- |
| `agentKey`             | Key   | Blackboard key cho `NavMeshAgent` component trên AI.                                          |
| `targetTransformKey`   | Key   | Blackboard key (của type `Transform`) cho target để di chuyển đến.                           |
| `updateInterval`       | float | Tần suất cập nhật destination tính bằng giây. `0` có nghĩa là mỗi frame.                     |

### Hành vi

-   **On Enter:** Lấy agent và target, sau đó đặt destination ban đầu.
-   **On Process:**
    -   **Trả về `Failure`** nếu agent hoặc target bị thiếu.
    -   **Trả về `Success`** khi agent đến destination.
    -   **Trả về `Running`** trong khi agent đang di chuyển về phía target.
-   **On Exit:** Dừng agent bằng cách gọi `agent.ResetPath()`.

<Aside type="caution">
Node này yêu cầu `NavMeshAgent` component trên AI của bạn và NavMesh đã được bake trong scene.
</Aside>

<Tabs>
<TabItem label="C# Code">
```csharp
// --- START OF FILE MoveToTransformNode.cs ---
using UnityEngine;
using UnityEngine.AI;

namespace ND_BehaviorTree
{
    [NodeInfo("Move To Transform", "Action/MoveToTransform", true, false)]
    public class MoveToTransformNode : ActionNode
    {
        [Tooltip("The Blackboard key for the NavMeshAgent component on the AI.")]
        public Key agentKey;
        [Tooltip("The Blackboard key (of type Transform) for the target to move towards.")]
        public Key targetTransformKey;
        [Tooltip("How often, in seconds, to update the agent's destination.")]
        public float updateInterval = 0.25f;
        private NavMeshAgent agent;
        private Transform targetTransform;
        private float timeSinceLastUpdate = 0f;

        protected override void OnEnter()
        {
            if (agentKey != null && blackboard != null) agent = blackboard.GetValue<NavMeshAgent>(agentKey.keyName);
            if (targetTransformKey != null && blackboard != null) targetTransform = blackboard.GetValue<Transform>(targetTransformKey.keyName);
            if (agent == null || targetTransform == null) return;
            agent.SetDestination(targetTransform.position);
            timeSinceLastUpdate = 0f;
        }

        protected override Status OnProcess()
        {
            if (agent == null || targetTransform == null) return Status.Failure;
            timeSinceLastUpdate += Time.deltaTime;
            if (timeSinceLastUpdate >= updateInterval)
            {
                agent.SetDestination(targetTransform.position);
                timeSinceLastUpdate = 0f;
            }
            if (!agent.pathPending && agent.remainingDistance <= agent.stoppingDistance) return Status.Success;
            return Status.Running;
        }

        protected override void OnExit()
        {
            if (agent != null && agent.hasPath) agent.ResetPath();
        }
    }
}
```
</TabItem>
</Tabs>